<!--Extract HTTP | rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""-->
<form version="1.1" theme="dark">
  <label>Web Activity</label>
  <description>Add Windows Web Monitors. Only works for Apache</description>
  <fieldset submitButton="true" autoRun="false">
    <input type="time" token="field1">
      <label></label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="checkbox" token="log_path" searchWhenChanged="true">
      <label>Web Log Path</label>
      <choice value="/var/log/apache2/access.log">/var/log/apache2/</choice>
      <choice value="/var/log/httpd/access.log">/var/log/httpd/</choice>
      <default>/var/log/apache2/access.log,/var/log/httpd/access.log</default>
      <initialValue>/var/log/apache2/access.log,/var/log/httpd/access.log</initialValue>
      <valuePrefix>source="</valuePrefix>
      <delimiter> OR </delimiter>
      <valueSuffix>"</valueSuffix>
    </input>
    <input type="dropdown" token="host" searchWhenChanged="true">
      <label>Host</label>
      <default>*</default>
      <fieldForLabel>host</fieldForLabel>
      <fieldForValue>host</fieldForValue>
      <search>
        <query>index=linux earliest=-24h@h latest=now
| dedup host
| table host</query>
      </search>
      <prefix>host=</prefix>
    </input>
    <input type="text" token="client_ip" searchWhenChanged="true">
      <label>Client IP</label>
      <default>*</default>
      <prefix>Client_IP=*</prefix>
      <suffix>*</suffix>
      <initialValue>*</initialValue>
    </input>
    <input type="text" token="code" searchWhenChanged="true">
      <label>HTTP Response Code</label>
      <default>*</default>
      <prefix>HTTP_Response_Code=*</prefix>
      <suffix>*</suffix>
      <initialValue>*</initialValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>HTTP Site Logins or Configuration Changes via GUI</title>
      <input type="text" token="method2" searchWhenChanged="true">
        <label>HTTP Request Method</label>
        <default>*</default>
      </input>
      <input type="text" token="monitor" searchWhenChanged="true">
        <label>Path to Monitor</label>
        <default>*</default>
      </input>
      <table>
        <title>$host$, $client_ip$, $code$, $monitor$, $method2$</title>
        <search>
          <query>index=linux $log_path$ NOT("*Splunk Website Monitoring*") 
| search $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$
| search $client_ip$
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_URL=urldecode(HTTP_Request_URL)
| eval Request_Path=urldecode(HTTP_Request_Path)
| search (HTTP_Request_Method=*$method2$* AND (HTTP_Request_Method=POST OR HTTP_Request_Method=PUT)) AND ((Request_Path=*$monitor$* OR Request_URL=*$monitor$* ) AND (Request_Path=*.php OR Request_URL=*.php))
| stats count by Client_IP Target_IP HTTP_Response_Code HTTP_Request_Method Request_URL</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
    <panel>
      <title>HTTP Site Logins or Configuration Changes via GUI</title>
      <chart>
        <title>$host$, $client_ip$, $code$, $monitor$, $method2$</title>
        <search>
          <query>index=linux $log_path$ $host$ NOT("*Splunk Website Monitoring*") 
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$
| search $client_ip$
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_URL=urldecode(HTTP_Request_URL)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| search (HTTP_Request_Method=*$method2$* AND (HTTP_Request_Method=POST OR HTTP_Request_Method=PUT)) AND ((Request_Path=*$monitor$* OR Request_URL=*$monitor$* ) AND (Request_Path=*.php OR Request_URL=*.php))
| timechart count by Client_IP</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Identify Spike in HTTP Response Codes</title>
      <chart>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| search $code$
| search $client_ip$
| timechart count by HTTP_Response_Code</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">all</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>Identify Spike in HTTP Request Methods</title>
      <chart>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$ $host$ NOT("*Splunk Website Monitoring*")
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| search $code$
| search $client_ip$
| timechart count by HTTP_Request_Method</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">all</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>Attacker IPs (Based on SQLi, XSS, LFI/RFI Attacks )</title>
      <chart>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL) 
| search ((Request_Path="* and *" OR Request_Path="* or *" OR Request_Path="* xor *" OR Request_Path="*%*" OR Request_Path="* union *" OR Request_Path="*--*" OR Request_Path="*'*") AND Request_Path!="*&lt;script&gt;*") OR (Request_Path="*&lt;script&gt;*" OR Request_URL="*&lt;script&gt;*" OR Request_URL="*../*" OR Request_Path="*../*" OR Request_URL="*=file:///*" OR Request_Path="*=file:///*" OR Request_URL="*=/*" OR Request_Path="*=/*" OR Request_Path="*=http*" OR Request_URL="*=http*")
| search $code$ $client_ip$
| chart count by Client_IP</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.drilldown">all</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Identify Spike in Modifying HTTP Requests (POST, PUT, DELETE, TRACE, CONNECT)</title>
      <chart>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| search HTTP_Request_Method!=GET AND HTTP_Request_Method!=HEAD
| search $code$ 
| search $client_ip$
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL) 
| timechart count by Request_Path
| append 
    [ search index=linux source="/var/log/*access.log*" NOT("*Splunk Website Monitoring*")
    | rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
    | search HTTP_Request_Method!=GET AND HTTP_Request_Method!=HEAD
    | search $code$ 
| search $client_ip$
    | timechart count by HTTP_Request_Method ]</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.axisY2.enabled">1</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.overlayFields">POST,PUT,DELETE,CONNECT,TRACE,PATCH</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>Modified Paths (POST, PUT, DELETE, TRACE, CONNECT)</title>
      <chart>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| search $code$ 
| search $client_ip$
| search HTTP_Request_Method!=GET
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL) 
| chart count by Request_Path</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.drilldown">all</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top 7 HTTP Request Paths</title>
      <table>
        <title>$host$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| top HTTP_Request_Path limit=7 Target_IP</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
    <panel>
      <title>Interesting User-Agents (Non-Mozilla User-Agents)</title>
      <chart>
        <title>$host$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| search User_Agent!="Mozilla*" OR User_Agent="*nmap*" OR User_Agent="*nikto*"
| timechart count by User_Agent</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>SQLi Strings</title>
      <chart>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| search HTTP_Response_Code&gt;=200 AND HTTP_Response_Code&lt;300
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$ 
| search $client_ip$
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL) 
| search (Request_Path="* and *" OR Request_Path="* or *" OR Request_Path="* xor *" OR Request_Path="*%*" OR Request_Path="* union *" OR Request_Path="*--*" OR Request_Path="*'*") AND Request_Path!="*&lt;script&gt;*"
| rex field=Request_Path "\?\w+\=(?&lt;SQLi&gt;.*)"
| chart count by SQLi</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.drilldown">all</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>XSS Strings</title>
      <chart>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$ 
| search $client_ip$
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL) 
| search Request_Path="*&lt;script&gt;*" OR Request_URL="*&lt;script&gt;*"
| rex field=Request_Path "\?\w+\=(?&lt;XSS1&gt;.*)" | rex field=Request_URL "\?\w+\=(?&lt;XSS2&gt;.*)"
| eval XSS=if(XSS1!="NULL",XSS1,XSS2)
| chart count by XSS</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.drilldown">all</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>File Inclusion Strings</title>
      <chart>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$ 
| search $client_ip$
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL)
| search Request_URL="*../*" OR Request_Path="*../*" OR Request_URL="*=file:///*" OR Request_Path="*=file:///*" OR Request_URL="*=/*" OR Request_Path="*=/*" OR Request_Path="*=http*" OR Request_URL="*=http*"
| rex field=Request_Path "\?\w+\=(?&lt;FI1&gt;.*)" | rex field=Request_URL "\?\w+\=(?&lt;FI2&gt;.*)"
| eval FI=if(FI1!="NULL",FI1,FI2)
| chart count by FI</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>SQL Injection Attacks  --- (AND, OR, XOR, %, UNION, ',  --)</title>
      <table>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$ 
| search $client_ip$
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL) 
| search (Request_Path="* and *" OR Request_Path="* or *" OR Request_Path="* xor *" OR Request_Path="*%*" OR Request_Path="* union *" OR Request_Path="*--*" OR Request_Path="='*") AND Request_Path!="*&lt;script&gt;*"
| table _time Target_IP Client_IP HTTP_Response_Code HTTP_Request_Method Request_Path Request_URL</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>XSS Attacks (DOM, Reflected, and Stored) -- &lt;script&gt;</title>
      <table>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$ 
| search $client_ip$
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL) 
| search Request_Path="*&lt;script&gt;*" OR Request_URL="*&lt;script&gt;*"
| table _time Target_IP Client_IP HTTP_Response_Code HTTP_Request_Method Request_Path Request_URL</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>File Inclusion ((***LFI Directory Traversal Attack (../../) Will Have a Request_URL and Target_IP. Others Such As file:\\\ or ?field=/etc/passwd Will Not. *** RFIs Will Have 200 Responses))</title>
      <table>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$ 
| search $client_ip$
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL)
| search Request_URL="*../*" OR Request_Path="*../*" OR Request_URL="*=file:///*" OR Request_Path="*=file:///*" OR Request_URL="*=/*" OR Request_Path="*=/*" OR Request_Path="*=http*" OR Request_URL="*=http*"
| table _time Target_IP Client_IP HTTP_Response_Code HTTP_Request_Method Request_Path Request_URL</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>CSRF     (URL Edited in Browser)</title>
      <table>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| search $code$ 
| search $client_ip$
| dedup host,Client_IP,HTTP_Request_Method,HTTP_Response_Code,HTTP_Request,User_Agent
| eval Request_Path=urldecode(HTTP_Request_Path) 
| search (HTTP_Request="-" AND Request_Path="*/?*")
| table _time Client_IP User_Agent HTTP_Response_Code HTTP_Request_Method Request_Path</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>File Uploads</title>
      <input type="text" token="file_ext" searchWhenChanged="true">
        <label>File Extension</label>
        <default>*</default>
      </input>
      <input type="text" token="method" searchWhenChanged="true">
        <label>Upload HTTP Method</label>
        <default>*</default>
      </input>
      <input type="text" token="path" searchWhenChanged="true">
        <label>Upload Path</label>
        <default>*</default>
      </input>
      <table>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$ 
| search $client_ip$
| dedup host,Client_IP,HTTP_Response_Code,User_Agent,HTTP_Request,HTTP_Request_Path
| eval Request_Path=urldecode(HTTP_Request_Path) 
| eval Request_URL=urldecode(HTTP_Request_URL) 
| search ((Request_URL=*$file_ext$* AND Request_URL=*$path$*) OR (Request_Path=*$file_ext$* AND Request_Path=*$path$*)) AND HTTP_Request_Method=*$method$*
| table _time Target_IP Client_IP HTTP_Response_Code HTTP_Request_Method Request_Path Request_URL User_Agent</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Web Request Logs  (((Dedup on Client_IP, HTTP_Response_Code, HTTP_Request_Method, User_Agent, HTTP_Request_Path, and HTTP_Request ))</title>
      <table>
        <title>$host$, $client_ip$, $code$</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| fillnull value="/" HTTP_Request_URL
| eval Target_IP=coalesce(host,Target_IP)
| search $code$ 
| search $client_ip$
| dedup host,Client_IP,HTTP_Response_Code,User_Agent,HTTP_Request,HTTP_Request_Path
| table _time host Target_IP Client_IP HTTP_Response_Code HTTP_Request_Method User_Agent HTTP_Request_Path HTTP_Request</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Command Injection (WIP)</title>
      <table>
        <title>Doesnt Work b/c Parameters Sent Aren't Logged. You'd Need FW Logs For this :(((((((((((((((((((((((</title>
        <search>
          <query>index=linux  $log_path$  NOT("*Splunk Website Monitoring*") $host$
| rex field=_raw "(?&lt;Client_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*\]\s\"(?&lt;HTTP_Request_Method&gt;\w+)\s(?&lt;HTTP_Request_Path&gt;.+)\sHTTP\/1\.1\"\s(?&lt;HTTP_Response_Code&gt;\d{3}).+\"(?&lt;HTTP_Request&gt;.*)\"\s\"(?&lt;User_Agent&gt;\w.*)\""
| rex field=_raw "\"(?&lt;HTTP_Method&gt;\w+):\/\/(?&lt;Target_IP&gt;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?&lt;HTTP_Request_URL&gt;.*)\"\s\""
| search $code$ 
| search $client_ip$
| eval Request_URL=urldecode(HTTP_Request_URL)
| eval Request_Path=urldecode(HTTP_Request_Path) 
| search (Request_URL IN ("*;*","* cat*","* useradd*","* passwd*","* whoami*","*|*") OR Request_Path IN ("*;*","* cat*","* useradd*","* passwd*","* whoami*","*|*"))
| table _time Client_IP User_Agent HTTP_Response_Code HTTP_Request_Method Request_Path</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
</form>

<!-- SOURCE: ANNA ANDLER (c) 2023 | kogatana-x -->